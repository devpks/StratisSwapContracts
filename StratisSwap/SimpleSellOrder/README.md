# Simple Sell Order

A contract used to sell full SRC tokens at a specified price per token.

## Creating the Contract

### Hash

```text
2b7836f2973ed0a4237d7ef4fcd91ed106d089ea9649b78bed8e924a5b9ead5a
```

### ByteCode

```text
4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010200AE609AEB0000000000000000E00022200B013000001000000002000000000000C22E0000002000000040000000000010002000000002000004000000000000000400000000000000006000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000702E00004F000000000000000000000000000000000000000000000000000000004000000C000000542E00001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000C80E0000002000000010000000020000000000000000000000000000200000602E72656C6F6300000C000000004000000002000000120000000000000000000000000000400000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A42E0000000000004800000002000500D0230000840A000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001330030057000000000000000203280600000A0205166AFE037201000070280700000A020E04166AFE03723B000070280700000A0204280300000602052805000006020E0428070000060202280800000A6F0900000A28090000060217280B0000062A4602280A00000A72770000706F0B00000A2A4A02280A00000A7277000070036F0C00000A2A4602280A00000A72830000706F0D00000A2A4A02280A00000A7283000070036F0E00000A2A4602280A00000A728F0000706F0D00000A2A4A02280A00000A728F000070036F0E00000A2A4602280A00000A729D0000706F0B00000A2A4A02280A00000A729D000070036F0C00000A2A4602280A00000A72AB0000706F0F00000A2A4A02280A00000A72AB000070036F1000000A2A1330080071010000010000110202280A00000672BD000070280700000A0202280800000A6F0900000A022808000006281100000A72ED000070280700000A0228060000060334080228060000062B0103100102280400000603D90A0202280800000A6F1200000A06FE0516FE01721D010070280700000A032000E1F5056AD90B02022802000006166A725D010070198D0E00000125160228080000068C08000001A2251702280800000A6F0900000A8C08000001A22518078C0F000001A2166A281300000A0C02086F1400000AA5100000017277010070280700000A0202280800000606281500000A2602280800000A6F1200000A06DB0D09166A36130202280800000A6F0900000A09281500000A260202280600000603DB28070000060228060000062D070216280B0000061205FE1503000002120502280800000A6F0900000A7D0100000412050228040000067D020000041205037D03000004120502281600000A6F1700000A7D0400000411051304021104280100002B11042AA60202280800000A6F0900000A022808000006281900000A729B010070280700000A0216280B0000062A0013300800AF0000000200001102022802000006166A72B9010070188D0E00000125160228080000068C08000001A2251702281A00000A8C08000001A2166A281300000A0A066F1B00000A2D04166A2B0B066F1400000AA50F0000010B1202FE150400000212020228080000067D0500000412020228020000067D0600000412020228040000067D0700000412020228060000067D08000004120272CD0100707D09000004120202280A0000067D0A0000041202077D0B000004082A0042534A4201000100000000000C00000076342E302E33303331390000000005006C000000B0030000237E00001C0400004C03000023537472696E67730000000068070000F00100002355530058090000100000002347554944000000680900001C01000023426C6F6200000000000000020000015715A201090A000000FA0133001600000100000011000000040000000B0000000E0000000A0000001B000000050000000200000001000000050000000A00000001000000020000000200000001000000000091010100000000000600E000570206001F0157020600CC0044020F00770200000A000F01C4020A00DB02C4020A008000C4020A00BC02C4020A00F002C40206006C00B3010A000001C4020A005700C4020A00A700C4020600E902B30106000E00B3010600BA01B3010A007B01C402000000001500000000000100010001001000090200001900010001000A011000DC010000290001000F000A01100089020000290005000F0006003802A40006004300A80006000F03A80006008601A80006003102A4000600D001A40006004300A80006000F03A80006007600AB0006006E01AE0006004F00A80050200000000086183E02B1000100B320000000008608C20121000500C520000000008108CC01BB000500D820000000008608350062000600EA200000000081083F00C1000600FD200000000086080003620007000F210000000081080B03C1000700222100000000860822022100080034210000000081082D02BB00080047210000000086085D019700090059210000000081086A01C60009006C210000000086004603CB000A00E922000000008600FE0106000B0014230000000086008602D1000B0000000100940000000200D601000003004900000004001603000001005701000001005701000001005701000001005701000001005701000001003E0309003E02010011003E02060019003E020A0029003E02060059003E02060031003E02100031001D031600310060001C006100F30121003100B80026006900AE022B006900B902310069000100380069000B003D006900A30143006900AB014800410030035A0061003D01620031008C016600490047017200310019027600310082017E008900E8016200310077018300410024035A003100A202210049009602970021002B0014012E000B00E3002E001300EC002E001B000B014300230014014E008F00020001000000D001D60000004300DB0000000F03DB0000003102D60000006E01DF0002000200030001000300030002000400050001000500050002000600070001000700070002000800090001000900090002000A000B0001000B000B00048000000000000000000000000000000000DB0200000400000000000000000000009B001E00000000000100020001000000000000000000C40200000000030002000400020031008A0000000047657455496E7436340053657455496E743634003C4D6F64756C653E0053797374656D2E507269766174652E436F72654C6962006765745F5072696365007365745F50726963650070726963650042616C616E636500494D657373616765006765745F4D6573736167650056616C756554797065004F72646572547970650049536D617274436F6E7472616374537461746500736D617274436F6E74726163745374617465004950657273697374656E745374617465006765745F50657273697374656E7453746174650044656275676761626C6541747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500496E646578417474726962757465004465706C6F794174747269627574650052756E74696D65436F6D7061746962696C697479417474726962757465006765745F56616C7565006765745F52657475726E56616C75650076616C7565006765745F4973416374697665007365745F4973416374697665004C6F670049426C6F636B006765745F426C6F636B0043616C6C00536D617274436F6E74726163742E646C6C00476574426F6F6C00536574426F6F6C0053797374656D00426F6F6C65616E006765745F546F6B656E007365745F546F6B656E00746F6B656E005472616E73616374696F6E006765745F4E756D626572006765745F53656E64657200436C6F73654F726465720053696D706C6553656C6C4F72646572005472616E73666572006765745F53656C6C6572007365745F53656C6C6572004275796572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573004765744F7264657244657461696C73006765745F53756363657373006765745F416464726573730047657441646472657373005365744164647265737300537472617469732E536D617274436F6E74726163747300536D617274436F6E7472616374004F626A65637400495472616E73666572526573756C74006765745F416D6F756E74007365745F416D6F756E7400616D6F756E7400417373657274006F705F457175616C697479006F705F496E657175616C69747900616D6F756E74546F42757900000000395000720069006300650020006D007500730074002000620065002000670072006500610074006500720020007400680061006E0020003000003B41006D006F0075006E00740020006D007500730074002000620065002000670072006500610074006500720020007400680061006E0020003000000B54006F006B0065006E00000B50007200690063006500000D41006D006F0075006E007400000D530065006C006C0065007200001149007300410063007400690076006500002F43006F006E007400720061006300740020006900730020006E006F00740020006100630074006900760065002E00002F530065006E006400650072002000630061006E006E006F00740020006200650020006F0077006E00650072002E00003F4E006F007400200065006E006F007500670068002000660075006E0064007300200074006F00200063006F00760065007200200063006F00730074002E0000195400720061006E007300660065007200460072006F006D0000235400720061006E00730066006500720020006600610069006C007500720065002E00001D41007300730065007200740020006600610069006C00650064002E00001341006C006C006F00770061006E0063006500001F530069006D0070006C006500530065006C006C004F00720064006500720000000000F09123ED1143CB429185C015A1F5AD3F0004200101080320000105200101111105200101121D05200201020E04200012310420001121042000123505200111210E062002010E11210420010B0E052002010E0B042001020E052002010E020B07060B0B12250B110C110C07000202112111210320000B0B2005122511210B0E1D1C0B0320001C072002122511210B042000124506300101011E00040A01110C07070312250B111003200002087CEC85D7BEA7798E0306112102060B02060E02060209200401121D11210B0B052001011121042001010B0420010102052001110C0B042000111004280011210328000B032800020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F777301080100020000000000040100000000000000000000000000000000000010000000000000000000000000000000982E00000000000000000000B22E0000002000000000000000000000000000000000000000000000A42E0000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF2500200010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C000000C43E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

### Parameters

- `Address address` - The contract address of the src token being traded.
- `ulong price` - The amount of CRS per SRC token in stratoshis (e.g. 1CRS = 100_000_000).
- `ulong amount` - The amount of SRC tokens to sell in full. (e.g. 1 for 1SRC token)

### Post Deployment

After the contract is created the new contract address must be approved to spend the amount of SRC tokens specified in the `amount` parameter. Using Stratis Swap UI, this will be done for you.

- Call the `Approve(Address newOrderContractAddress, ulong oldBalance, ulong amount)` method at the provided `address` of the SRC token to be orderd.

Upon success, the `newOrderContractAddress` will have the required allowance to allow buyers to fill the order.

## Closing the Order

The creator of the contract has abilities to cancel the contract. This sets the `IsActive` flag to false preventing further user interaction.

- Call the `CloseOrder` method on the order contract address from the wallet address that created the order.

## Get Order Details

Call the `GetOrderDetails` method to receive the latest details about the order. The `balance` property on a sell order refers to the src `allowance` this contracts address has available to spend.

_Example Order Details_

```json
{
  "orderType": "SimpleSellOrder",
  "price": 10000000,
  "amount": 10,
  "isActive": true,
  "seller": "CV9FGxmLHxnpHwu2AmLKKuRUBjGX1yzkCZ",
  "token": "Cam6mmCcCv4zZN65ppF28tHLhT2DfwuU26",
  "balance": 100000000
}
```

## Filling an Order

For sell orders, all orders looking to fill the contract will call the `Buy(ulong amountToPurchase)` method supplying the amount of SRC tokens they'd like to purchase as a parameter. Note that the amount must be a full number. At this time, no decimals are allowed.

- Validations are run against contract details and buyer supplied parameters.
- SRC token amount is sent to `Message.Sender` (the buyer).
  - Upon failure, no funds will move.
  - Upon success, CRS tokens are transferred to the seller (owner of the contract).
- Any remaining balance from `Message.Sender` (the buyer) is returned to them
- Checks if there is a remaining `Amount` of SRC tokens to sell.
  - If fully filled - close contract and return `Transaction` result
  - If not fully filled - Update `Amount` and return `Transaction` result
    - Other Buyers can come and buy the remaining `Amount` until the order is closed or fully filled.

**Note** - You may also want to make a local call to the SRC tokens contract to verify that the order contract address is approved to send the necessary amount of tokens prior to attempting to settle a contract. Safe gaurds are in place if the contract isn't properly approved, but gas for calling the contract will be spent.

_Example Order Log_

```json
{
  "buyer": "CNXp26iEE3EbJC9RRLBZ2cYnP7a8L3Z84F",
  "price": 10000000,
  "amount": 10,
  "block": 12345
}
```
