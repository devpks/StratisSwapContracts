# Simple Buy Order

A contract used to buy full SRC tokens at a specified price per token.

## Creating the Contract

### Hash

```text
16932c69b9e5997f7d7b0aa948e6b21fa38de58f864b163e25a62a9ce65009ef
```

### ByteCode

```text
4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0102000DCDDAC40000000000000000E00022200B013000001000000002000000000000C62E0000002000000040000000000010002000000002000004000000000000000400000000000000006000000002000000000000030040850000100000100000000010000010000000000000100000000000000000000000742E00004F000000000000000000000000000000000000000000000000000000004000000C000000582E00001C0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000CC0E0000002000000010000000020000000000000000000000000000200000602E72656C6F6300000C000000004000000002000000120000000000000000000000000000400000420000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A82E0000000000004800000002000500A0230000B80A000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001330040076000000000000000203280600000A0205166AFE037201000070280700000A020E04166AFE03723B000070280700000A0202280800000A6F0900000A0E0405D9FE0516FE017277000070280700000A0204280300000602052805000006020E0428070000060202280800000A6F0A00000A28090000060217280B0000062A4602280B00000A72BF0000706F0C00000A2A4A02280B00000A72BF000070036F0D00000A2A4602280B00000A72CB0000706F0E00000A2A4A02280B00000A72CB000070036F0F00000A2A4602280B00000A72D70000706F0E00000A2A4A02280B00000A72D7000070036F0F00000A2A4602280B00000A72E50000706F0C00000A2A4A02280B00000A72E5000070036F0D00000A2A4602280B00000A72F10000706F1000000A2A4A02280B00000A72F1000070036F1100000A2A001330080047010000010000110202280A0000067203010070280700000A0202280800000A6F0A00000A022808000006281200000A7233010070280700000A0228060000060334080228060000062B0103100102280400000603D90A0202281300000A06FE0516FE017263010070280700000A032000E1F5056AD90B02022802000006166A72A3010070198D0E000001251602280800000A6F0A00000A8C08000001A225170228080000068C08000001A22518078C0F000001A2166A281400000A0C02086F1500000AA51000000172BD010070280700000A0202280800000A6F0A00000A06281600000A260202280600000603DB28070000060228060000062D0602280E0000061204FE1503000002120402280800000A6F0A00000A7D0100000412040228040000067D020000041204037D03000004120402281700000A6F1800000A7D0400000411040D0209280100002B092AA20202280800000A6F0A00000A022808000006281A00000A72E1010070280700000A02280E0000062A9602281300000A166A36130202280800000602281300000A281600000A260216280B0000062A00001330020064000000020000111200FE150400000212000228080000067D0500000412000228020000067D0600000412000228040000067D0700000412000228060000067D08000004120072FF0100707D09000004120002280A0000067D0A000004120002281300000A7D0B000004062A42534A4201000100000000000C00000076342E302E33303331390000000005006C000000B8030000237E0000240400004C03000023537472696E67730000000070070000200200002355530090090000100000002347554944000000A00900001801000023426C6F6200000000000000020000015715A201090A000000FA0133001600000100000011000000040000000B0000000F0000000A0000001A000000050000000200000001000000050000000A000000010000000200000002000000010000000000A7010100000000000600E40072020600230172020600D0005F020F00920200000A001301CF020A00E602CF020A008400CF020A00BF02CF020A00FB02CF0206007000D6010A000401CF020A005B00CF020A00AB00CF020600F402D60106000E00D6010600DD01D6010A009101CF02000000001500000000000100010001001000260200001900010001000A011000F90100002900010010000A011000A402000029000500100006003E029C0006004300A00006001A03A00006009C01A000060053029C000600F3019C0006004300A00006001A03A00006007A00A30006008401A60006005300A00050200000000086185902A9000100D220000000008608E50125000500E420000000008108EF01B3000500F72000000000860835002100060009210000000081083F00B90006001C210000000086080B03210007002E210000000081081603B9000700412100000000860845022500080053210000000081084F02B300080066210000000086087301BE00090078210000000081088001C20009008C21000000008600C101C7000A00DF220000000086001B0206000B000823000000008100410106000B003023000000008600A102CD000B0000000100980000000200C702000003004900000004002103000001006D01000001006D01000001006D01000001006D01000001006D0100000100B901090059020100110059020600190059020A00290059020600590059020600310059021000310028031600310064001C006100530121006100100225003100BC002A006900B1022F006900BC023500690001003C0069000B0041006900C60147006900CE014C0041003B035D0031004F0021003100A201650049005D017100310035027500310098017D0089000502210031008D01820041002F035D0021002B0010012E000B00DF002E001300E8002E001B00070143002300100152008E00020001000000F301D20000004300D70000001A03D70000005302D20000008401DB0002000200030001000300030002000400050001000500050002000600070001000700070002000800090001000900090002000A000B0001000B000B00048000000000000000000000000000000000E602000004000000000000000000000093001E00000000000100020001000000000000000000CF020000000003000200040002003300890000000047657455496E7436340053657455496E743634003C4D6F64756C653E0053797374656D2E507269766174652E436F72654C6962006765745F5072696365007365745F5072696365007072696365006765745F42616C616E636500494D657373616765006765745F4D6573736167650056616C756554797065004F72646572547970650049536D617274436F6E7472616374537461746500736D617274436F6E74726163745374617465004950657273697374656E745374617465006765745F50657273697374656E7453746174650044656275676761626C6541747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500496E646578417474726962757465004465706C6F794174747269627574650052756E74696D65436F6D7061746962696C69747941747472696275746500436C6F73654F7264657245786563757465006765745F56616C7565006765745F52657475726E56616C75650076616C7565006765745F4973416374697665007365745F4973416374697665004C6F670049426C6F636B006765745F426C6F636B0043616C6C00536D617274436F6E74726163742E646C6C00616D6F756E74546F53656C6C00476574426F6F6C00536574426F6F6C0053797374656D00426F6F6C65616E006765745F546F6B656E007365745F546F6B656E005472616E73616374696F6E006765745F4E756D626572006765745F53656E64657200436C6F73654F726465720053696D706C654275794F72646572005472616E736665720053656C6C6572006765745F4275796572007365745F4275796572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F646573004765744F7264657244657461696C7300476574416464726573730053657441646472657373006164647265737300537472617469732E536D617274436F6E74726163747300536D617274436F6E7472616374004F626A65637400495472616E73666572526573756C74006765745F416D6F756E74007365745F416D6F756E7400616D6F756E7400417373657274006F705F457175616C697479006F705F496E657175616C6974790000000000395000720069006300650020006D007500730074002000620065002000670072006500610074006500720020007400680061006E0020003000003B41006D006F0075006E00740020006D007500730074002000620065002000670072006500610074006500720020007400680061006E00200030000047420061006C0061006E006300650020006900730020006E006F007400200065006E006F00750067006800200074006F00200063006F00760065007200200063006F0073007400000B54006F006B0065006E00000B50007200690063006500000D41006D006F0075006E007400000B42007500790065007200001149007300410063007400690076006500002F43006F006E007400720061006300740020006900730020006E006F00740020006100630074006900760065002E00002F530065006E006400650072002000630061006E006E006F00740020006200650020006F0077006E00650072002E00003F4E006F007400200065006E006F007500670068002000660075006E0064007300200074006F00200063006F00760065007200200063006F00730074002E0000195400720061006E007300660065007200460072006F006D0000235400720061006E00730066006500720020006600610069006C007500720065002E00001D41007300730065007200740020006600610069006C00650064002E00001D530069006D0070006C0065004200750079004F00720064006500720000000000BFB1755AECFF2E49811CDA85C85DE7040004200101080320000105200101111105200101121D05200201020E04200012310320000B0420001121042000123505200111210E062002010E11210420010B0E052002010E0B042001020E052002010E020A07050B0B1225110C110C07000202112111210B2005122511210B0E1D1C0B0320001C072002122511210B042000124506300101011E00040A01110C0407011110087CEC85D7BEA7798E0306112102060B02060E02060209200401121D11210B0B052001011121042001010B032000020420010102052001110C0B042000111004280011210328000B032800020801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000401000000000000000000000000000000000000100000000000000000000000000000009C2E00000000000000000000B62E0000002000000000000000000000000000000000000000000000A82E0000000000000000000000005F436F72446C6C4D61696E006D73636F7265652E646C6C0000000000FF25002000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000C000000C83E00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

### Parameters

- `Address address` - The contract address of the src token being traded.
- `ulong price` - The amount of crs per src token in stratoshis (e.g. 1crs = 100_000_000).
- `ulong amount` - The amount of src tokens to buy in full. (e.g. 1 for 1src token)

## Closing the Order

The creator of the contract has abilities to cancel the contract. This sets the `IsActive` flag to false preventing further user interaction and also returns any `Balance` on the contract back to the owner.

- Call the `CloseOrder` method on the order contract address.

## Get Order Details

Call the `GetOrderDetails` method to receive the latest details about the order.

```json
{
  "orderType": "SimpleBuyOrder",
  "price": 10000000,
  "amount": 10,
  "balance": 100000000,
  "isActive": true,
  "buyer": "CV9FGxmLHxnpHwu2AmLKKuRUBjGX1yzkCZ",
  "token": "Cam6mmCcCv4zZN65ppF28tHLhT2DfwuU26"
}
```

## Filling an Order

### Aproving SRC Tokens

Prior to filling an order, the seller must approve the contract address to spend the amount of SRC tokens specified in the `amount` parameter. Using Stratis Swap UI, this will be done for you.

- Call the `Approve(Address orderContractAddress, ulong oldBalance, ulong amount)` method at the provided `address` of the SRC token to be orderd.

Upon success, the `orderContractAddress` will have the required allowance necessary when filling via the `Sell` method.

### Sell Method

For buy orders, all orders looking to fill the contract will call the `Sell(ulong amountToSell)` method supplying the amount of SRC tokens they'd like to sell as a parameter.

- Validations are run against contract details and seller supplied parameters.
- Src token amount is sent to the buyer.
  - Upon success, CRS tokens are transferred to seller.
  - Upon failure, no funds will move.
- Checks if there is a remaining `Amount` of SRC tokens to buy.
  - If fully filled - close contract and return `Transaction` result
  - If not fully filled - Update `Amount` and return `Transaction` result
    - Other Sellers can come and sell the remaining `Amount` until the order is closed or fully filled.

```json
// Logged and returned transaction JSON
{
  "seller": "CNXp26iEE3EbJC9RRLBZ2cYnP7a8L3Z84F",
  "price": 10000000,
  "amount": 10,
  "block": 12345
}
```
